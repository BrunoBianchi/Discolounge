<%- include('../partials/favicon'); %>
<title translate="no">Discolounge - Add Bot </title>

<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.5/socket.io.js" integrity="sha512-2rUSTSAeOO02jF6eBqENNqPs1EohenJ5j+1dgDPdXSLz9nOlrr8DJk4zW/lDy8rjhGCSonW3Gx812XJQIKZKJQ==" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.css" integrity="sha512-3pIirOrwegjM6erE5gPSwkUzO+3cTjpnV9lexlNZqvupR64iZBnOOTiiLPb9M36zpMScbmUNIcHUqKD47M719g==" crossorigin="anonymous" /><script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.min.js"></script>
<script src="https://kit.fontawesome.com/3bad20df7c.js" crossorigin="anonymous"></script>
<script type="text/javascript" src="/amsify.js"></script> 
<link rel="stylesheet" type="text/css" href="/amsify.css">
<link rel="stylesheet" type="text/css" href="/dashboard.css">
<link rel="stylesheet" type="text/css" href="/editor.css">

<link rel="stylesheet" href="/home.css">
<%- include('../partials/navbar'); %>



<!-- End vertical navbar -->


<div id="form" class="container">

    <div class="form-content" >
        <div class="form-group">
          <label id="tags_header" for="exampleFormControlSelect1">Bot's Id <span style="color:#de4343">*</span></label>
          <div class="input-group mb-3">
            <input name='id' id='bot_id'style="border:none;background-color:white;color:black" type="text" class="form-control" placeholder="bot's Id " aria-label="Recipient's username" aria-describedby="basic-addon2" required>
            <div class="input-group-append">
              <span class="input-group-text" id="verify">
                <div id="spinner" style="width:15px;height:15px" class="spinner-border none" role="status">
              </div>
              <span><i  style="color:#5fe068;font-size:25px;" id="success" class="fas fa-check-circle none"></i></span>
              <span><i  style="color:#e05f5f;font-size:25px;" id="error" class="fas fa-exclamation-circle none"></i></span>
            </span>
            </div>
          </div>
        </div>
      </div>
      <div  class="next none">
        <div class="form-content" >
            <div class="form-group">
              <label id="tags_header" for="exampleFormControlSelect1">Tags <span style="color:#de4343">*</span></label>
              <input type="text" id="tags" value="community"  class="form-control" name="tags" required>
            </div>
          </div>
          <div class="form-content">
            <div class="form-group">
              <label id="short_description_header" for="exampleFormControlSelect1">Short Description <span style="color:#de4343">*</span></label>
              <textarea name='short_description' style="height:150px" id="SD"  placeholder="Write a unique short description about your bot" class="form-control" required></textarea>
            </div>
          </div>
          <div class="form-content">
            <div class="form-group">
              <label id="long_description_header" for="exampleFormControlSelect1">Long Description <span style="color:#de4343">*</span></label>
              <div id="markdown-editor">
                <div class="toolbar">
                  <div class="group">
                    <button id="heading1"><i class="fa fa-header" aria-hidden="true"></i>1</button>
                    <button id="heading2"><i class="fa fa-header" aria-hidden="true"></i>2</button>
                    <button id="heading3"><i class="fa fa-header" aria-hidden="true"></i>3</button>
                  </div>
                  <div class="group">
                    <button id="bold"><i class="fa fa-bold" aria-hidden="true"></i></button>
                    <button id="italic"><i class="fa fa-italic" aria-hidden="true"></i></button>
                  </div>
                  <div class="group">
                    <button id="link"><i class="fa fa-link" aria-hidden="true"></i></button>
                    <button id="list-ul"><i class="fa fa-list-ul" aria-hidden="true"></i></button>
                    <button id="list-ol"><i class="fa fa-list-ol" aria-hidden="true"></i></button>
                    <button id="token">{{Token}}</button>
                  </div>
                  <button id="preview">Preview</button>
                </div>
                <div id="input-output">
                  <textarea name="long_description" id="input-area" rows="30" cols="50" required></textarea>
                  <div id="output-area"></div>
                  <p class="preview-message">Preview Mode</p>
                </div>
              </div>
            </div>
          </div>
          <div class="form-content" >
              <div class="form-group">
                <label id="tags_header" for="exampleFormControlSelect1">Bot invite <span style="color:#de4343">*</span></label>
                <input type="text" name="invite" id="bot_invite"  class="form-control"  required>
              </div>
            </div>
      
      
          <div class="form-content">
            <div class="form-group">
              <input id="s2d" type="checkbox"  name="NSFW" value="false" onClick="if(this.value === 'false') {this.value = true }else {this.value =false}" class="switch"  >
              <label for="s2d">NSFW</label>
              <button style="float:right"  id="confirm-btn" onclick="confirm()">Save Changes</button>
            </div>
      
          </div>
      </div>

    <%- include('../partials/footer'); %>

    </div>
      <%- include('../partials/footer'); %>
      
      
      <!-- End demo content -->
      
      
      
        
        <style>
      
      
      .label-info {
        background-color: #5bc0de;
        padding: 3px;
      }
        </style>

          <script>
            var typingTimer;                //timer identifier
var doneTypingInterval = 400;  //time in ms, 5 seconds for example
var $input = $('#bot_id');

//on keyup, start the countdown
$input.on('keyup', function () {
  clearTimeout(typingTimer);
  typingTimer = setTimeout(doneTyping, doneTypingInterval);
});

//on keydown, clear the countdown 
$input.on('keydown', function () {
  clearTimeout(typingTimer);
});

//user is "finished typing," do something
function doneTyping () {
    $("#spinner").removeClass("none");
    $("#error").addClass("none");
    fetch(`/bots/verifyId?id=${$input.val()}`, { method: "POST",
      headers: { "Content-Type": "application/json" },
      
      })
      .then(res => res.json())
      .then(async response => {
        if(response.next) {
            $("#success").removeClass("none");
            $("#spinner").addClass("none");
            $(".next").removeClass("none");

            $input.prop("readonly", true);

        } else {
            $("#error").removeClass("none");
            $("#spinner").addClass("none");
            toastr[response.icon](response.content)

        }
      })  
}
                $(function () {
        $('[data-toggle="tooltip"]').tooltip()
      })
      function confirm() {
        var divElem = document.getElementById("form");
      var inputElements = divElem.querySelectorAll("input, textarea");
      var el = {}
      inputElements.forEach(i=>{
        el[`${i.name}`] = {
        name:i.name,
        content:i.value,
        required:i.hasAttribute("required"),
          id:i.id,
      }
      })
      fetch(`/bots/add?id=${$input.val()}`, { method: "POST",
      headers: { "Content-Type": "application/json" },
      
      body:JSON.stringify(el),
      })
      .then(res => res.json())
      .then(async response => {
        
        toastr[response.icon](response.content)
        if(response.page) {
          window.location = response.page
        }
      })     
      }  
          </script>
   
    </div>
  </div>
</div>

  <script>
    $('#sidebarCollapse').on('click', function() {
$('#nav').toggleClass('active');
});
</script>
